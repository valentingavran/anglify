@use 'variables' as *;

::ng-deep {
  label .container .checkbox-custom-icons {
    anglify-icon {
      --anglify-icon-size-regular: #{$checkbox-custom-icon-size};
    }
  }

  input:disabled + .container .checkbox-custom-icons {
    anglify-icon {
      color: $checkbox-disabled-color;
    }
  }

  input:checked:not([disabled]) + .container .checkbox-custom-icons {
    anglify-icon {
      color: $checkbox-checked-color;
    }
  }
}

:host {
  display: block;
  user-select: none;

  .before {
    flex-flow: row-reverse;
  }

  label {
    position: relative;
    display: flex;

    .container {
      position: relative;
      display: flex;
      overflow: visible;
      width: $checkbox-ripple-inner-width;
      height: $checkbox-ripple-inner-height;

      .state-container {
        position: absolute;
        width: $checkbox-ripple-width;
        height: $checkbox-ripple-height;
        margin: $checkbox-ripple-margin;
        border-radius: $checkbox-ripple-border-radius;
      }

      .check-box-effect {
        position: relative;
        display: inline-flex;
        width: $checkbox-width;
        height: $checkbox-height;
        border-width: $checkbox-border-width;
        border-style: solid;
        border-color: $checkbox-border-color;
        margin: auto;
        border-radius: $checkbox-border-radius;
        pointer-events: none;

        &::after {
          position: absolute;
          top: $checkbox-icon-after-top-position;
          left: $checkbox-icon-after-left-position;
          width: 0;
          height: $checkbox-icon-after-height;
          background: $checkbox-icon-color;
          border-radius: 3px;
          content: '';
          transform: rotate(305deg);
          transform-origin: 0% 0%;
          transition: width 50ms ease;
        }

        &::before {
          position: absolute;
          top: $checkbox-icon-before-top-position;
          left: $checkbox-icon-before-left-position;
          width: 0;
          height: $checkbox-icon-before-height;
          background: $checkbox-icon-color;
          border-radius: 3px;
          content: '';
          transform: rotate(45deg);
          transform-origin: 0% 0%;
          transition: width 50ms ease 50ms;
        }
      }

      /* stylelint-disable-next-line no-descending-specificity */
      .checkbox-custom-icons {
        width: $checkbox-custom-icon-size;
        height: $checkbox-custom-icon-size;
      }
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      padding: $checkbox-label-margin;
      font: $checkbox-label-font;
      letter-spacing: $checkbox-label-letter-spacing;
      text-transform: $checkbox-label-text-transform;
    }
  }

  input {
    position: absolute;
    opacity: 0; // Input should be hidden but we still want it to be focusable
    pointer-events: none;
    user-select: none;
  }

  // Unchecked styles for only enabled state
  input:not(:disabled) {
    & ~ .checkbox-label,
    & ~ .container .state-container {
      cursor: pointer;
    }

    & ~ .container {
      .state-container:hover {
        --state-container-color: #{$checkbox-hover-state-inactive-color};
      }
    }
  }

  // Unchecked styles for only disabled state
  input:disabled {
    & ~ .checkbox-label {
      color: $checkbox-disabled-color;
    }
  }

  // Unchecked styles for both enabled and disabled state
  input:not(:checked) {
    &:focus-visible {
      & ~ .container {
        --state-container-color: #{$checkbox-focus-state-inactive-color};
      }
    }
  }

  // Checked styles for both enabled and disabled state
  /* stylelint-disable-next-line no-descending-specificity */
  input:checked {
    /* stylelint-disable-next-line no-descending-specificity */
    & ~ .container {
      .check-box-effect {
        border-color: $checkbox-checked-border-color;
        background-color: $checkbox-checked-color !important;

        &::before {
          width: $checkbox-icon-before-width;
          background: $checkbox-checked-icon-color;
          transition: $checkbox-checked-icon-transition-speed;
        }

        &::after {
          width: $checkbox-icon-after-width;
          background: $checkbox-checked-icon-color;
          transition: $checkbox-checked-icon-transition-speed;
        }
      }
    }

    &:focus-visible {
      & ~ .container {
        --state-container-color: #{$checkbox-focus-state-active-color};
      }
    }
  }

  // Checked styles for only disabled state
  input:checked:disabled + .container .check-box-effect {
    border-color: transparent;
    background-color: $checkbox-disabled-color !important;
  }

  // Checked styles for only enabled state
  input:checked:not(:disabled) {
    & ~ .checkbox-label,
    & ~ .container .state-container {
      cursor: pointer;
    }

    & ~ .container {
      .state-container:hover {
        --state-container-color: #{$checkbox-hover-state-active-color};
      }
    }
  }
}
